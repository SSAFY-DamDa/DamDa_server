<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.journey.model.mapper.JourneyMapper">

    <!-- ResultMap for JourneyDto -->
    <resultMap id="JourneyResultMap" type="com.ssafy.journey.model.JourneyDto">
        <id property="id" column="id" />
        <result property="title" column="title" />
        <result property="startDate" column="start_date" />
        <result property="endDate" column="end_date" />
        <result property="personnel" column="personnel" />
        <result property="color" column="color" />
    </resultMap>

    <!-- Insert Journey -->
    <insert id="insertJourney" parameterType="com.ssafy.journey.model.JourneyDto" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO journeys (title, start_date, end_date, personnel, color)
        VALUES (#{title}, #{startDate}, #{endDate}, #{personnel}, #{color})
    </insert>

    <!-- Insert Journey Route -->
    <insert id="insertJourneyRoute" parameterType="com.ssafy.journey.model.JourneyRouteDto">
        INSERT INTO journey_routes (journey_id, day, order_in_day, content_id)
        VALUES (#{journeyId}, #{day}, #{orderInDay}, #{contentId})
    </insert>

    <!-- Insert Member Journey -->
    <insert id="insertMemberJourney" parameterType="map">
        INSERT INTO member_journey (user_id, journey_id)
        VALUES (#{userId}, #{journeyId})
    </insert>

    <!-- Select Journey By ID -->
    <select id="selectJourneyById" parameterType="int" resultMap="JourneyResultMap">
        SELECT * FROM journeys
        WHERE id = #{id}
    </select>

</mapper>
